# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤:

```bash
cd backend
python3 scripts/setup_secrets.py
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ `.env` —Ñ–∞–π–ª–∞
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç `.env` –∏–∑ `.env.example` –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `SECRET_KEY` –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç `DATABASE_URL`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ `Settings`

## –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª

```bash
cd backend
cp .env.example .env
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SECRET_KEY

–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π SECRET_KEY:

```bash
python3 -c "import secrets; print(secrets.token_urlsafe(64))"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `.env`:

```env
SECRET_KEY=–≤–∞—à-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–ª—é—á-–∑–¥–µ—Å—å
```

**–í–∞–∂–Ω–æ:** SECRET_KEY –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞!

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DATABASE_URL

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```env
DATABASE_URL=postgresql+asyncpg://user:password@host:port/dbname
```

–ü—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```env
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/dnevnik_uspekha
```

### 4. –î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```env
# –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
DEBUG=False

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_LEVEL=INFO
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
python3 scripts/setup_secrets.py
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –≥–∞–ª–æ—á–∫–∏ ‚úÖ.

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª –≤ git!** –û–Ω —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `.gitignore`
2. **SECRET_KEY –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–¥–∞–∫—à–µ–Ω)
3. **–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ `.env` —Ñ–∞–π–ª–∞ –¥–ª—è –±–æ–ª—å—à–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. **–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ SECRET_KEY**, –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ JWT —Ç–æ–∫–µ–Ω—ã —Å—Ç–∞–Ω—É—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "SECRET_KEY is not set"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `.env` —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ `backend/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ `SECRET_KEY=...`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python3 scripts/setup_secrets.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –û—à–∏–±–∫–∞: "DATABASE_URL is not set"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `.env` —Ñ–∞–π–ª–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ `DATABASE_URL=...`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç: `postgresql+asyncpg://user:password@host:port/dbname`

### –û—à–∏–±–∫–∞ 401 Unauthorized

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ –µ—â–µ –ø–æ–ª—É—á–∞–µ—Ç–µ 401 –æ—à–∏–±–∫–∏:

1. **–û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã** - –æ–Ω–∏ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã —Å–æ —Å—Ç–∞—Ä—ã–º SECRET_KEY:
   ```javascript
   // –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
   localStorage.removeItem('admin_token');
   ```

2. **–í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ** - –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º SECRET_KEY

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ç–æ–∫–µ–Ω–æ–≤

## –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ `.env` —Ñ–∞–π–ª–∞:

```bash
export SECRET_KEY="–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á"
export DATABASE_URL="postgresql+asyncpg://..."
```

–ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ systemd, docker-compose, –∏–ª–∏ –≤–∞—à –¥–µ–ø–ª–æ–π-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç.

