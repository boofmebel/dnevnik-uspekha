# –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –†–§

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã

–°–æ–∑–¥–∞–Ω —Ä–æ—É—Ç `/api/legal` —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏:
- `GET /api/legal/terms` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
- `GET /api/legal/privacy` - –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- `GET /api/legal/subscription` - –£—Å–ª–æ–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

**–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**
- ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è –∏–≥—Ä–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –±–µ–∑ –¥–µ–Ω–µ–∂–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- ‚úÖ –ù–µ—Ç –æ–±–µ—â–∞–Ω–∏–π –¥–æ—Ö–æ–¥–∞ –∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≤—ã–≥–æ–¥—ã
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π (–§–ó-152)
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤
- ‚úÖ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è –¥–µ—Ç–µ–π

### 2. –ü–æ–¥–ø–∏—Å–∫–∞

**–ú–æ–¥–µ–ª—å `Subscription`:**
- `user_id` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `start_date` - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
- `end_date` - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- `is_active` - –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞
- `refund_requested` - –∑–∞–ø—Ä–æ—à–µ–Ω –ª–∏ –≤–æ–∑–≤—Ä–∞—Ç
- `refund_reason` - –ø—Ä–∏—á–∏–Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `GET /api/subscription/` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∫–µ
- `POST /api/subscription/consent` - –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
- `POST /api/subscription/cancel` - –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è)
- `POST /api/subscription/refund-request` - –ó–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤ (—Ç—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `Notification`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –≤–æ–∑–º–æ–∂–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π
- ‚úÖ –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –∞—É–¥–∏—Ç–∞

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∂–∞–ª–æ–±—ã

**–ú–æ–¥–µ–ª—å `Notification`:**
- `type` - —Ç–∏–ø (subscription, refund, complaint, consent, system)
- `message` - —Å–æ–æ–±—â–µ–Ω–∏–µ
- `status` - —Å—Ç–∞—Ç—É—Å (pending, sent, read, failed)
- `metadata` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON)

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `POST /api/support/complaint` - –û—Ç–ø—Ä–∞–≤–∫–∞ –∂–∞–ª–æ–±—ã (—Ç—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è)

**–§—É–Ω–∫—Ü–∏—è `send_notification`:**
- –®–∞–±–ª–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é (email/push/telegram)

### 4. –°–æ–≥–ª–∞—Å–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π

**–ú–æ–¥–µ–ª—å `ParentConsent`:**
- `user_id` - —Ä–æ–¥–∏—Ç–µ–ª—å
- `child_id` - —Ä–µ–±—ë–Ω–æ–∫
- `consent_given` - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ
- `consent_date` - –¥–∞—Ç–∞ —Å–æ–≥–ª–∞—Å–∏—è
- `ip_address` - IP –∞–¥—Ä–µ—Å (–¥–ª—è –∞—É–¥–∏—Ç–∞)
- `user_agent` - User-Agent (–¥–ª—è –∞—É–¥–∏—Ç–∞)

**–§—É–Ω–∫—Ü–∏—è `check_parent_consent`:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–æ–≥–ª–∞—Å–∏—è –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–±—ë–Ω–∫–∞
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º: POST, PUT, DELETE –¥–ª—è –∑–∞–¥–∞—á, –∑–≤—ë–∑–¥, –∫–æ–ø–∏–ª–∫–∏, –¥–Ω–µ–≤–Ω–∏–∫–∞, —Å–ø–∏—Å–∫–∞ –∂–µ–ª–∞–Ω–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–∫, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø–æ–¥–ø–∏—Å–∫–∏

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚ùå "–¥–µ–Ω—å–≥–∏" ‚Üí ‚úÖ "–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞" (–¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ –ø–æ–¥–∞—Ä–∫–∏)
- ‚ùå "–∑–∞—Ä–∞–±–æ—Ç–æ–∫" ‚Üí ‚úÖ "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã", "–∏–≥—Ä–æ–≤—ã–µ –±–∞–ª–ª—ã"
- ‚ùå "–∑–∞—Ä–∞–±–æ—Ç–∫–∞" ‚Üí ‚úÖ "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥"
- ‚ùå "–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å" ‚Üí ‚úÖ "–ø–æ–ª—É—á–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã"

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:**
- –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
- –°—Ö–µ–º—ã Pydantic —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–ø–∏—Å–∞–Ω–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–µ–π
- –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 6. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–∞–º –†–§

**–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω ‚Ññ 152-–§–ó "–û –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö":**
- ‚úÖ –°–æ–≥–ª–∞—Å–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞—É–¥–∏—Ç–∞
- ‚úÖ –ü—Ä–∞–≤–æ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –Ω–∞ –æ—Ç–∑—ã–≤ —Å–æ–≥–ª–∞—Å–∏—è
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ó–∞—â–∏—Ç–∞ –¥–µ—Ç–µ–π:**
- ‚úÖ –ù–µ—Ç –æ–±–µ—â–∞–Ω–∏–π –¥–æ—Ö–æ–¥–∞ –∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≤—ã–≥–æ–¥—ã
- ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è –∏–≥—Ä–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –†–æ–¥–∏—Ç–µ–ª–∏ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –¥–µ–π—Å—Ç–≤–∏—è –¥–µ—Ç–µ–π
- ‚úÖ –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–¥–ø–∏—Å–∫–æ–π —Ç—Ä–µ–±—É—é—Ç —Å–æ–≥–ª–∞—Å–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π

**–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞:**
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∂–∞–ª–æ–± —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

### –ú–æ–¥–µ–ª–∏
- `models/subscription.py` - Subscription
- `models/parent_consent.py` - ParentConsent
- `models/notification.py` - Notification

### –†–æ—É—Ç–µ—Ä—ã
- `routers/legal.py` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
- `routers/subscription.py` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
- `routers/support.py` - –ñ–∞–ª–æ–±—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### –°—Ö–µ–º—ã
- `schemas/legal.py` - LegalTextResponse
- `schemas/subscription.py` - Subscription, ParentConsent —Å—Ö–µ–º—ã
- `schemas/notification.py` - Notification, Complaint —Å—Ö–µ–º—ã

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- `repositories/subscription_repository.py` - SubscriptionRepository, ParentConsentRepository
- `repositories/notification_repository.py` - NotificationRepository

### –°–µ—Ä–≤–∏—Å—ã
- `services/notification_service.py` - NotificationService

### Dependencies
- `core/dependencies.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `check_parent_consent`

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–±—ë–Ω–∫–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞—É–¥–∏—Ç–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –ù–µ –Ω–∞—Ä—É—à–∞—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–µ —Ä–æ—É—Ç—ã –∏ –º–æ–¥–µ–ª–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç async-first –ø–æ–¥—Ö–æ–¥
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç FastAPI best practices
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –†–§

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
```bash
GET /api/legal/terms
GET /api/legal/privacy
GET /api/legal/subscription
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏–µ–º
```bash
POST /api/subscription/consent
{
  "child_id": 1,
  "consent_given": true
}
```

### –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏
```bash
POST /api/subscription/cancel
{
  "reason": "–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é —Å–µ—Ä–≤–∏—Å"
}
```

### –ó–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—Ç–∞
```bash
POST /api/subscription/refund-request
{
  "reason": "–ù–µ –ø–æ–¥–æ—à—ë–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª",
  "parent_consent": true
}
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∂–∞–ª–æ–±—ã
```bash
POST /api/support/complaint
{
  "subject": "–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º",
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã...",
  "parent_consent": true
}
```

