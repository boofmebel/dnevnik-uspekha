# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Backend API

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (SQLAlchemy)
- ‚úÖ User - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Ä–æ–¥–∏—Ç–µ–ª–∏ –∏ –¥–µ—Ç–∏)
- ‚úÖ Child - –¥–µ—Ç–∏
- ‚úÖ Task - –∑–∞–¥–∞—á–∏ (—á–µ–∫-–ª–∏—Å—Ç –∏ –∫–∞–Ω–±–∞–Ω)
- ‚úÖ Star, StarHistory, StarStreak - –∑–≤—ë–∑–¥—ã –∏ —Å–µ—Ä–∏–∏ –¥–Ω–µ–π
- ‚úÖ Piggy, PiggyGoal, PiggyHistory - –∫–æ–ø–∏–ª–∫–∞
- ‚úÖ Settings - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—É—Ä—Å–∞ –æ–±–º–µ–Ω–∞
- ‚úÖ DiaryEntry - –∑–∞–ø–∏—Å–∏ –¥–Ω–µ–≤–Ω–∏–∫–∞
- ‚úÖ WishlistItem - —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –∂–µ–ª–∞–Ω–∏–π
- ‚úÖ WeeklyStat - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º

### 2. –°—Ö–µ–º—ã (Pydantic)
- ‚úÖ –°—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π (Create, Update, Response)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö endpoints

### 3. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- ‚úÖ UserRepository
- ‚úÖ ChildRepository
- ‚úÖ TaskRepository
- ‚úÖ StarRepository
- ‚úÖ PiggyRepository
- ‚úÖ SettingsRepository

### 4. –°–µ—Ä–≤–∏—Å—ã (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
- ‚úÖ TaskService - —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏
- ‚úÖ StarService - —Ä–∞–±–æ—Ç–∞ —Å–æ –∑–≤—ë–∑–¥–∞–º–∏, –æ–±–º–µ–Ω, streak, –Ω–∞–≥—Ä–∞–¥—ã
- ‚úÖ PiggyService - —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–ø–∏–ª–∫–æ–π
- ‚úÖ AuthService - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Å—Å–∏–µ–π)

### 5. –†–æ—É—Ç–µ—Ä—ã (API endpoints)
- ‚úÖ `/api/auth/*` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (login, refresh, logout)
- ‚úÖ `/api/children/*` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç—å–º–∏
- ‚úÖ `/api/tasks/*` - CRUD –¥–ª—è –∑–∞–¥–∞—á
- ‚úÖ `/api/stars/*` - —Ä–∞–±–æ—Ç–∞ —Å–æ –∑–≤—ë–∑–¥–∞–º–∏ (get, add, exchange, check-streak)
- ‚úÖ `/api/piggy/*` - —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–ø–∏–ª–∫–æ–π (get, update goal, add money)

### 6. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î (async)
- ‚úÖ Dependencies –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–µ–±—ë–Ω–∫–∞
- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 7. –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Alembic
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω env.py –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å async

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Frontend —Å Backend
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `api.js` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ endpoints
- [ ] –°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä –≤ `data.js` –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### 2. –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π
- [ ] –ú–∏–Ω–∏-–Ω–∞–≥—Ä–∞–¥—ã (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ 5, 10, 25 –∑–≤—ë–∑–¥)
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–µ–ª–∏ (–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- [ ] –î–Ω–µ–≤–Ω–∏–∫ (endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- [ ] –°–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π (endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints
- [ ] `/api/settings/*` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- [ ] `/api/diary/*` - —Ä–∞–±–æ—Ç–∞ —Å –¥–Ω–µ–≤–Ω–∏–∫–æ–º
- [ ] `/api/wishlist/*` - —Ä–∞–±–æ—Ç–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –∂–µ–ª–∞–Ω–∏–π
- [ ] `/api/stats/*` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–µ–ª–∏

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è API
- [ ] –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è FastAPI)
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- [ ] –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å localStorage –Ω–∞ API

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ backend:

```bash
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
uvicorn main:app --reload
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```bash
# –í—Ö–æ–¥
curl -X POST "http://localhost:8000/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com", "password": "password"}'

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)
curl -X GET "http://localhost:8000/api/tasks/" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫—Ä–æ–º–µ `/api/auth/login`)
- Access token –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
- Refresh token –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ cookie
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic —Å—Ö–µ–º—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è async/await –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:
- `SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT
- `DATABASE_URL` - URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `ALLOWED_ORIGINS` - —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ origins –¥–ª—è CORS
- `DEBUG` - —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

