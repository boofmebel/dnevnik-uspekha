<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#10b981" />
  <title>–î–Ω–µ–≤–Ω–∏–∫ —É—Å–ø–µ—Ö–∞ - –°–∏—Å—Ç–µ–º–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="static/css/styles.css?v=8" />
  <link rel="stylesheet" href="static/css/auth.css?v=3" />
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
  <script src="src/js/theme.js"></script>
  <script src="src/js/error-handler.js"></script>
  <script src="src/js/utils.js"></script>
  <script src="src/js/data.js"></script>
  <script src="src/js/ui.js"></script>
  <script src="src/js/api.js"></script>
  <script src="src/js/router.js"></script>
</head>
<body>
<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ -->
<div id="parent-content" style="display: none;"></div>
<div id="child-content" style="display: none;"></div>
<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
<div class="modal auth-modal" id="auth-modal" style="display: none;">
  <div class="modal-content auth-modal-content">
    <div class="auth-header">
      <h1>üåü –î–Ω–µ–≤–Ω–∏–∫ —É—Å–ø–µ—Ö–∞</h1>
      <p class="auth-subtitle" id="auth-subtitle">–í—Ö–æ–¥</p>
    </div>
    
    <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
    <form id="login-form" class="auth-form" style="display: block;">
      <div class="form-group">
        <label for="login-phone-input">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
        <div class="phone-input-wrapper">
          <span class="phone-prefix">+7</span>
          <input 
            type="tel" 
            id="login-phone-input" 
            placeholder="(999) 123-45-67" 
            required 
            maxlength="15"
            autocomplete="tel"
          />
        </div>
      </div>
      
      <div class="form-group">
        <label for="login-password-input">–ü–∞—Ä–æ–ª—å</label>
        <div class="password-input-wrapper">
          <input 
            type="password" 
            id="login-password-input" 
            placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" 
            required 
            autocomplete="current-password"
          />
          <button type="button" class="password-toggle" onclick="togglePassword('login-password-input')">
            üëÅÔ∏è
          </button>
        </div>
      </div>
      
      <div id="login-error-message" class="error-message" style="display: none;"></div>
      
      <button type="submit" class="auth-button primary" id="login-button">
        –í–æ–π—Ç–∏
      </button>
      
      <div class="auth-footer">
        <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="switchToRegister(); return false;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
      </div>
    </form>
    
    <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <form id="register-form-modal" class="auth-form" style="display: none;">
      <div class="form-group">
        <label for="register-phone-input">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
        <div class="phone-input-wrapper">
          <span class="phone-prefix">+7</span>
          <input 
            type="tel" 
            id="register-phone-input" 
            placeholder="(999) 123-45-67" 
            required 
            maxlength="15"
            autocomplete="tel"
          />
        </div>
        <small class="form-hint">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7 (XXX) XXX-XX-XX</small>
      </div>
      
      <div class="form-group">
        <label for="register-name-input">–ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è</label>
        <input 
          type="text" 
          id="register-name-input" 
          placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" 
          required
          minlength="2"
          autocomplete="name"
        />
        <small class="form-hint">–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?</small>
      </div>
      
      <div class="form-group">
        <label for="register-password-input">–ü–∞—Ä–æ–ª—å</label>
        <div class="password-input-wrapper">
          <input 
            type="password" 
            id="register-password-input" 
            placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" 
            required 
            minlength="8"
            autocomplete="new-password"
          />
          <button type="button" class="password-toggle" onclick="togglePassword('register-password-input')">
            üëÅÔ∏è
          </button>
        </div>
        <small class="form-hint">–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</small>
      </div>
      
      <div id="register-error-message" class="error-message" style="display: none;"></div>
      
      <button type="submit" class="auth-button primary" id="register-button-modal">
        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
      </button>
      
      <div class="auth-footer">
        <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="switchToLogin(); return false;">–í–æ–π—Ç–∏</a></p>
      </div>
    </form>
  </div>
</div>

<div id="app-content" style="display: none;">
<header>
  <div class="header-content">
    <div class="header-left">
      <button class="profile-avatar" onclick="openChildrenModal()" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç—å–º–∏" id="parent-avatar-btn" style="position: relative;">
        <div class="avatar-circle" id="profile-avatar">üë§</div>
        <div class="add-child-indicator" title="–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∞–≤–∞—Ç–∞—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ—Ç—å–º–∏">+</div>
      </button>
    </div>
    <div class="header-center">
      <span class="header-title">–î–Ω–µ–≤–Ω–∏–∫ —É—Å–ø–µ—Ö–∞</span>
      <div class="header-name-row">
        <span class="header-name" id="header-child-name" style="font-size: 14px; opacity: 0.9;"></span>
      </div>
    </div>
    <div class="header-right">
      <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
        <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
        <div id="theme-toggle-container"></div>
        <!-- –ó–≤–µ–∑–¥—ã -->
        <div class="header-stars" onclick="openStarsExchangeModal()">
          <span class="stars-count" id="header-stars-count">0</span>
          <span class="stars-icon">‚≠ê</span>
        </div>
      </div>
    </div>
  </div>
</header>

<div class="container">
  <!-- –ß–µ–∫-–ª–∏—Å—Ç—ã -->
  <div class="page active" id="checklist">
    <div class="card">
      <div class="card-header">
        <h2>‚úÖ –ú–æ–∏ –¥–µ–ª–∞</h2>
        <button class="add-btn-small" onclick="openAddTaskModal('checklist')" title="–î–æ–±–∞–≤–∏—Ç—å">+</button>
      </div>
      <ul id="checklist-items" class="checklist-list">
        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
      </ul>
    </div>
    
    <div class="card">
      <div class="card-header">
        <h2>‚≠ê –ó–≤—ë–∑–¥—ã —Å–µ–≥–æ–¥–Ω—è</h2>
      </div>
      <div class="stars-display">
        <div class="stars-count" id="today-stars">0</div>
        <div class="stars-label">‚≠ê</div>
      </div>
      <div id="streak-display" style="display: none; margin: 12px 0;"></div>
      <div class="stars-info">
        <p>15 ‚≠ê = 200 ‚ÇΩ</p>
        <div class="progress">
          <div class="progress-bar" id="stars-progress" style="width: 0%"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ö–∞–Ω–±–∞–Ω -->
  <div class="page" id="kanban">
    <div class="card">
      <div class="card-header">
        <h2>üìã –ú–æ–∏ –∑–∞–¥–∞–Ω–∏—è</h2>
        <button class="add-btn-small" onclick="openAddTaskModal('kanban')" title="–î–æ–±–∞–≤–∏—Ç—å">+</button>
      </div>
      <div class="kanban" id="kanban-board">
        <div class="kanban-column" data-column="todo">
          <div class="column-header"><strong>–ù—É–∂–Ω–æ</strong></div>
          <div class="tasks-container" id="todo-tasks"></div>
        </div>
        <div class="kanban-column" data-column="doing">
          <div class="column-header"><strong>–î–µ–ª–∞—é</strong></div>
          <div class="tasks-container" id="doing-tasks"></div>
        </div>
        <div class="kanban-column" data-column="done">
          <div class="column-header"><strong>–ì–æ—Ç–æ–≤–æ üéâ</strong></div>
          <div class="tasks-container" id="done-tasks"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ö–æ–ø–∏–ª–∫–∞ -->
  <div class="page" id="piggy">
    <div class="card piggy">
      <div class="card-header">
        <h2>üéØ –ú–æ—è —Ü–µ–ª—å</h2>
      </div>
      <div class="money-display">
        <div class="money" id="piggy-amount">0 ‚ÇΩ</div>
        <div class="money-goal" id="piggy-goal">/ 0 ‚ÇΩ</div>
      </div>
      <div class="progress">
        <div class="progress-bar" id="piggy-progress" style="width: 0%"></div>
      </div>
      <div class="goal-controls">
        <button class="money-btn minus" onclick="openPiggyModal('minus')" title="–£–±—Ä–∞—Ç—å">‚àí</button>
        <div class="goal-text-wrapper">
          <p class="goal-text" id="goal-text">–¶–µ–ª—å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</p>
        </div>
        <button class="money-btn plus" onclick="openPiggyModal('plus')" title="–î–æ–±–∞–≤–∏—Ç—å">+</button>
      </div>
    </div>
    
    <div class="card">
      <h2>üí∞ –ö–∞—Ä–º–∞–Ω–Ω—ã–µ –¥–µ–Ω—å–≥–∏</h2>
      <div class="money-stats-compact">
        <div class="stat-compact">
          <span class="stat-icon">‚≠ê</span>
          <span class="stat-value-compact" id="total-stars">0</span>
          <span class="stat-label-compact">–í—Å–µ–≥–æ –∑–≤—ë–∑–¥</span>
        </div>
        <div class="stat-compact">
          <span class="stat-icon">üí∞</span>
          <span class="stat-value-compact" id="total-money">0 ‚ÇΩ</span>
          <span class="stat-label-compact">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</span>
        </div>
        <div class="stat-compact">
          <span class="stat-icon">üíµ</span>
          <span class="stat-value-compact" id="wallet-amount">0 ‚ÇΩ</span>
          <span class="stat-label-compact">–í –∫–æ—à–µ–ª—å–∫–µ</span>
        </div>
      </div>
      <div class="conversion-info">
        <p><strong id="conversion-text">15 ‚≠ê = 200 ‚ÇΩ</strong></p>
        <div class="progress">
          <div class="progress-bar" id="money-progress" style="width: 0%"></div>
        </div>
        <p class="next-reward" id="next-reward">–°–ª–µ–¥—É—é—â–∞—è –≤—ã–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑: 15 ‚≠ê</p>
      </div>
      <div class="money-history-section">
        <h3 style="font-size: 16px; margin: 16px 0 12px; color: #666;">üí∏ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç</h3>
        <div id="money-history" class="history-list">
          <p class="empty-state">–ù–µ—Ç –≤—ã–ø–ª–∞—Ç</p>
        </div>
      </div>
    </div>
    
    <div class="card">
      <h2>üéÅ –°–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π</h2>
      <div id="wishlist-items" class="wishlist-list">
        <p class="empty-state">–ù–µ—Ç –∂–µ–ª–∞–Ω–∏–π</p>
      </div>
      <button class="action-button" onclick="openWishModal()">–î–æ–±–∞–≤–∏—Ç—å –∂–µ–ª–∞–Ω–∏–µ</button>
    </div>
    
    <div class="card">
      <h2>üìä –ò—Å—Ç–æ—Ä–∏—è</h2>
      <div id="piggy-history" class="history-list">
        <p class="empty-state">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏</p>
      </div>
    </div>
  </div>

  <!-- –î–Ω–µ–≤–Ω–∏–∫ -->
  <div class="page" id="diary">
    <div class="card">
      <div class="card-header">
        <h2>üìî –ú–æ–π –¥–Ω–µ–≤–Ω–∏–∫</h2>
        <button class="add-btn-small" onclick="openDiaryEntryModal()" title="–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å">+</button>
      </div>
      <div id="diary-entries" class="diary-entries">
        <p class="empty-state">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π. –ù–∞–∂–º–∏ + —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!</p>
      </div>
    </div>
  </div>

  <!-- –î–µ—Ç–∏ -->
  <div class="page" id="children">
    <div class="card">
      <h2>üë∂ –ú–æ–∏ –¥–µ—Ç–∏</h2>
      <div id="children-list">
        <!-- –°–ø–∏—Å–æ–∫ –¥–µ—Ç–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JS -->
      </div>
    </div>
  </div>

  <!-- –ü—Ä–∞–≤–∏–ª–∞ -->
  <div class="page" id="rules">
    <div class="card">
      <h2>üìú –ù–∞—à–∏ –ø—Ä–∞–≤–∏–ª–∞</h2>
      <ul id="rules-list" class="rules-list">
        <li>üì± –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ 21:00</li>
        <li>üõè –°–æ–Ω –≤–∞–∂–Ω–µ–µ —ç–∫—Ä–∞–Ω–∞</li>
        <li>üå∏ –û—à–∏–±–∞—Ç—å—Å—è –º–æ–∂–Ω–æ</li>
        <li>‚ù§Ô∏è –†–æ–¥–∏—Ç–µ–ª–∏ –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º</li>
      </ul>
      <button class="action-button" onclick="openRuleModal()">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ</button>
    </div>
  </div>

  <!-- –î–∞—à–±–æ—Ä–¥ -->
  <div class="page" id="stats">
    <div class="card">
      <h2>üìä –î–∞—à–±–æ—Ä–¥</h2>
      <div id="weekly-stats-content">
        <p class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞ -->
<div class="modal" id="add-child-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10001; align-items: center; justify-content: center;">
  <div class="modal-content" style="max-width: 500px; width: 90%; padding: 24px; background: white; border-radius: 16px; max-height: 90vh; overflow-y: auto;">
    <h2 style="margin: 0 0 20px 0; text-align: center;">üë∂ –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞</h2>
    <form id="add-child-form" onsubmit="createChild(event)">
      <!-- –ê–≤–∞—Ç–∞—Ä -->
      <div style="text-align: center; margin-bottom: 24px;">
        <div id="child-avatar-preview" style="
          width: 120px;
          height: 120px;
          border-radius: 50%;
          margin: 0 auto 16px;
          background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
          border: 3px solid var(--border-color);
          cursor: pointer;
          position: relative;
          overflow: hidden;
        " onclick="document.getElementById('child-avatar-input').click()">
          <input type="file" id="child-avatar-input" accept="image/*" style="display: none;" onchange="onAvatarUpload(event)">
          <div style="
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.5);
            color: white;
            padding: 8px;
            font-size: 12px;
            text-align: center;
          ">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ</div>
        </div>
      </div>
      
      <!-- –ò–º—è -->
      <div class="form-group" style="margin-bottom: 20px;">
        <label for="child-name" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">–ò–º—è —Ä–µ–±–µ–Ω–∫–∞</label>
        <input type="text" id="child-name" required placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" style="
          width: 100%;
          padding: 12px 16px;
          border: 2px solid var(--input-border);
          border-radius: 12px;
          font-size: 16px;
          box-sizing: border-box;
        ">
      </div>
      
      <!-- –ü–æ–ª -->
      <div class="form-group" style="margin-bottom: 20px;">
        <label for="child-gender" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">–ü–æ–ª</label>
        <select id="child-gender" onchange="onGenderChange()" style="
          width: 100%;
          padding: 12px 16px;
          border: 2px solid var(--input-border);
          border-radius: 12px;
          font-size: 16px;
          box-sizing: border-box;
          background: white;
          color: #0f172a;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
        ">
          <option value="none" style="color: #0f172a; background: white;">–ù–µ —É–∫–∞–∑–∞–Ω</option>
          <option value="boy" style="color: #0f172a; background: white;">–ú–∞–ª—å—á–∏–∫</option>
          <option value="girl" style="color: #0f172a; background: white;">–î–µ–≤–æ—á–∫–∞</option>
        </select>
      </div>
      
      <!-- –í–æ–∑—Ä–∞—Å—Ç -->
      <div class="form-group" style="margin-bottom: 24px;">
        <label for="child-age" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">–í–æ–∑—Ä–∞—Å—Ç</label>
        <input type="number" id="child-age" min="0" max="18" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç" style="
          width: 100%;
          padding: 12px 16px;
          border: 2px solid var(--input-border);
          border-radius: 12px;
          font-size: 16px;
          box-sizing: border-box;
        ">
      </div>
      
      <!-- –ö–Ω–æ–ø–∫–∏ -->
      <div style="display: flex; gap: 12px;">
        <button type="button" onclick="closeAddChildModal()" style="
          flex: 1;
          padding: 14px;
          border: 2px solid var(--border-color);
          border-radius: 12px;
          background: white;
          color: var(--text-primary);
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
        ">–û—Ç–º–µ–Ω–∞</button>
        <button type="submit" style="
          flex: 1;
          padding: 14px;
          border: none;
          border-radius: 12px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
        ">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </form>
  </div>
</div>

<!-- –ê–¥–º–∏–Ω–∫–∞ -->
<div class="admin-panel" id="admin-panel">
  <div class="admin-content">
    <div class="admin-header">
      <h2>‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</h2>
      <button class="close-btn" onclick="toggleAdmin()">√ó</button>
    </div>
    
    <div class="admin-section">
      <h3>üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</h3>
      <input type="text" id="admin-task-input" placeholder="–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ" />
      <select id="admin-task-type">
        <option value="checklist">–ß–µ–∫-–ª–∏—Å—Ç</option>
        <option value="kanban">–ö–∞–Ω–±–∞–Ω</option>
      </select>
      <button class="admin-btn" onclick="addTaskFromAdmin()">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
    </div>
    
    <div class="admin-section">
      <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—É—Ä—Å–∞</h3>
      <input type="number" id="admin-stars-to-money" placeholder="–ó–≤—ë–∑–¥ –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã" min="1" />
      <input type="number" id="admin-money-per-stars" placeholder="–†—É–±–ª–µ–π –∑–∞ –≤—ã–ø–ª–∞—Ç—É" min="1" />
      <button class="admin-btn" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—É—Ä—Å</button>
    </div>
    
    <div class="admin-section">
      <h3>üéØ –¶–µ–ª—å –∫–æ–ø–∏–ª–∫–∏</h3>
      <input type="text" id="admin-goal-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏" />
      <input type="number" id="admin-goal-amount" placeholder="–°—É–º–º–∞ (‚ÇΩ)" min="0" />
      <button class="admin-btn" onclick="setGoalFromAdmin()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å</button>
    </div>
    
    <div class="admin-section">
      <h3>üí∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–Ω—å–≥–∞–º–∏</h3>
      <input type="number" id="admin-add-money" placeholder="–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–ø–∏–ª–∫—É (‚ÇΩ)" min="0" />
      <button class="admin-btn" onclick="addMoneyToPiggy()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <input type="number" id="admin-add-stars" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–≤—ë–∑–¥—ã" min="0" />
      <button class="admin-btn" onclick="addStars()">–î–æ–±–∞–≤–∏—Ç—å ‚≠ê</button>
      <button class="admin-btn danger" onclick="payOutMoney()">–í—ã–ø–ª–∞—Ç–∏—Ç—å –¥–µ–Ω—å–≥–∏</button>
    </div>
    
    <div class="admin-section">
      <h3>üîÑ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö</h3>
      <button class="admin-btn danger" onclick="resetDailyTasks()">–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–ª–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</button>
      <button class="admin-btn danger" onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
    </div>
    
    <div class="admin-section">
      <h3>üíæ –î–∞–Ω–Ω—ã–µ</h3>
      <button class="admin-btn" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç</button>
      <button class="admin-btn" onclick="importData()">–ò–º–ø–æ—Ä—Ç</button>
      <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleFileImport(event)" />
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
<div class="modal" id="add-task-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h3>
      <button class="close-btn" onclick="closeAddTaskModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="new-task-text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" />
      <button class="submit-btn" onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ü–µ–ª–∏ -->
<div class="modal" id="goal-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å</h3>
      <button class="close-btn" onclick="closeGoalModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="goal-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ù–∞—É—à–Ω–∏–∫–∏)" />
      <input type="number" id="goal-amount-input" placeholder="–°—É–º–º–∞ (‚ÇΩ)" min="0" />
      <button class="submit-btn" onclick="setGoal()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª–∞ -->
<div class="modal" id="rule-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ</h3>
      <button class="close-btn" onclick="closeRuleModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="new-rule-text" placeholder="–¢–µ–∫—Å—Ç –ø—Ä–∞–≤–∏–ª–∞" />
      <button class="submit-btn" onclick="addFamilyRule()">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–≥—Ä–∞–¥—ã -->
<div class="modal" id="reward-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="reward-title">üéâ –ù–∞–≥—Ä–∞–¥–∞!</h3>
      <button class="close-btn" onclick="closeRewardModal()">√ó</button>
    </div>
    <div class="modal-body">
      <p id="reward-message" style="text-align: center; font-size: 18px; margin: 20px 0;"></p>
      <button class="submit-btn" onclick="closeRewardModal()">–û—Ç–ª–∏—á–Ω–æ!</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∑–≤–µ–∑–¥ –≤ –¥–µ–Ω—å–≥–∏ -->
<div class="modal" id="stars-exchange-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>‚≠ê –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–≤—ë–∑–¥ –≤ –¥–µ–Ω—å–≥–∏</h3>
      <button class="close-btn" onclick="closeStarsExchangeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 24px; font-weight: 700; margin-bottom: 8px;">
          <span id="exchange-total-stars">0</span> ‚≠ê
        </div>
        <div style="font-size: 14px; color: #666;">
          –ö—É—Ä—Å: <span id="exchange-rate-text">15 ‚≠ê = 200 ‚ÇΩ</span>
        </div>
      </div>
      
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 8px; font-weight: 600;">–°–∫–æ–ª—å–∫–æ –∑–≤—ë–∑–¥ –æ–±–º–µ–Ω—è—Ç—å?</label>
        <input type="number" id="exchange-stars-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" style="width: 100%; padding: 12px; font-size: 16px; border: 2px solid #e5e7eb; border-radius: 8px; box-sizing: border-box;" />
      </div>
      
      <div style="background: #f3f4f6; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
          <span style="color: #666;">–í—ã –ø–æ–ª—É—á–∏—Ç–µ:</span>
          <span id="exchange-money-result" style="font-size: 20px; font-weight: 700; color: #10b981;">0 ‚ÇΩ</span>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
          <span>–û—Å—Ç–∞–Ω–µ—Ç—Å—è –∑–≤—ë–∑–¥:</span>
          <span id="exchange-stars-remaining">0 ‚≠ê</span>
        </div>
      </div>
      
      <button class="submit-btn" onclick="exchangeStarsToMoney()" id="exchange-submit-btn" style="width: 100%;">
        –û–±–º–µ–Ω—è—Ç—å
      </button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É–º–º—ã –∫–æ–ø–∏–ª–∫–∏ -->
<div class="modal" id="piggy-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="piggy-modal-title">–ò–∑–º–µ–Ω–∏—Ç—å —Å—É–º–º—É</h3>
      <button class="close-btn" onclick="closePiggyModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="number" id="piggy-amount-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É (‚ÇΩ)" min="0" step="1" autofocus />
      <button class="submit-btn" onclick="savePiggyAmount()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–ø–∏—Å–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫ -->
<div class="modal" id="diary-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="diary-modal-title">–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</h3>
      <button class="close-btn" onclick="closeDiaryEntryModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="diary-title-input" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" />
      <textarea id="diary-content-input" placeholder="–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å–µ–≥–æ–¥–Ω—è, —á—Ç–æ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å, –æ —á–µ–º –¥—É–º–∞–µ—à—å..." rows="8"></textarea>
      <button class="submit-btn" onclick="saveDiaryEntry()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∂–µ–ª–∞–Ω–∏—è -->
<div class="modal" id="wish-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>üéÅ –î–æ–±–∞–≤–∏—Ç—å –∂–µ–ª–∞–Ω–∏–µ</h3>
      <button class="close-btn" onclick="closeWishModal()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="wish-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∂–µ–ª–∞–Ω–∏—è" />
      <input type="number" id="wish-price-input" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)" min="0" />
      <textarea id="wish-description-input" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" rows="3"></textarea>
      <button class="submit-btn" onclick="saveWish()">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
<div class="modal" id="profile-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
      <button class="close-btn" onclick="closeProfileModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="profile-avatar-large">
        <div class="avatar-circle-large" id="profile-avatar-large">üë§</div>
        <input type="file" id="avatar-upload" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)" />
        <button class="change-avatar-btn" onclick="document.getElementById('avatar-upload').click()">–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ</button>
      </div>
      
      <div class="profile-form">
        <div class="form-group">
          <label for="profile-name-input">–ò–º—è</label>
          <input type="text" id="profile-name-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="50" />
        </div>
        
        <div class="form-group">
          <label>–ü–æ–ª</label>
          <div class="gender-selector">
            <button class="gender-btn" data-gender="girl" onclick="selectGender('girl')">
              <span class="gender-icon">üëß</span>
              <span class="gender-label">–î–µ–≤–æ—á–∫–∞</span>
            </button>
            <button class="gender-btn" data-gender="boy" onclick="selectGender('boy')">
              <span class="gender-icon">üë¶</span>
              <span class="gender-label">–ú–∞–ª—å—á–∏–∫</span>
            </button>
            <button class="gender-btn" data-gender="none" onclick="selectGender('none')">
              <span class="gender-icon">üë§</span>
              <span class="gender-label">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
            </button>
          </div>
        </div>
        
        <button class="submit-btn" onclick="saveProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="submit-btn" onclick="handleLogout()" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); margin-top: 12px;">–í—ã–π—Ç–∏</button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ç–æ -->
<div class="modal" id="crop-modal">
  <div class="modal-content crop-modal-content">
    <div class="modal-header">
      <h3>‚úÇÔ∏è –ö–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ç–æ</h3>
      <button class="close-btn" onclick="closeCropModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="crop-container">
        <div class="crop-preview" id="crop-preview">
          <div class="crop-mask"></div>
          <div class="crop-image-wrapper" id="crop-image-wrapper">
            <img id="crop-image" src="" alt="Preview" draggable="false" />
          </div>
        </div>
      </div>
      <div class="crop-hint">
        <p>üí° –ü–µ—Ä–µ–º–µ—â–∞–π—Ç–µ —Ñ–æ—Ç–æ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ/—É–º–µ–Ω—å—à–∞–π—Ç–µ –ø–∞–ª—å—Ü–∞–º–∏ –∏–ª–∏ –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏</p>
      </div>
      <div class="crop-actions">
        <button class="cancel-btn" onclick="closeCropModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="submit-btn" onclick="applyCrop()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
</div>

<div class="menu">
  <button class="active" onclick="openPage('checklist', this)">
    <span class="menu-icon">‚úÖ</span>
    <span class="menu-label">–î–µ–ª–∞</span>
  </button>
  <button onclick="openPage('kanban', this)">
    <span class="menu-icon">üìã</span>
    <span class="menu-label">–ó–∞–¥–∞–Ω–∏—è</span>
  </button>
  <button onclick="openPage('piggy', this)">
    <span class="menu-icon">üéØ</span>
    <span class="menu-label">–¶–µ–ª—å</span>
  </button>
  <button onclick="openPage('diary', this)">
    <span class="menu-icon">üìî</span>
    <span class="menu-label">–î–Ω–µ–≤–Ω–∏–∫</span>
  </button>
  <button onclick="openPage('stats', this)">
    <span class="menu-icon">üìä</span>
    <span class="menu-label">–î–∞—à–±–æ—Ä–¥</span>
  </button>
  <button onclick="openPage('rules', this)">
    <span class="menu-icon">üìú</span>
    <span class="menu-label">–ü—Ä–∞–≤–∏–ª–∞</span>
  </button>
</div>

<script src="src/js/auth-user.js"></script>
<script src="src/js/app.js"></script>

<!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞ -->
<script>
// –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤
(async function() {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (admin —É–±—Ä–∞–Ω –∏–∑ product SPA)
  await Promise.all([
    loadScript('/src/js/routes/index.js'),
    loadScript('/src/js/routes/parent.js'),
    loadScript('/src/js/routes/child.js')
  ]);
  
  // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –º–∞—Ä—à—Ä—É—Ç—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è product users)
  router.route('/', handleRootRoute);
  router.route('/parent', handleParentRoute);
  router.route('/child', handleChildRoute);
  
  // /admin –±–æ–ª—å—à–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è - –∞–¥–º–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç /staff/login
  
  console.log('‚úÖ –†–æ—É—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –º–∞—Ä—à—Ä—É—Ç—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã:', Object.keys(router.routes));
  
  // –¢–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –º–∞—Ä—à—Ä—É—Ç –ü–û–°–õ–ï —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  router.handleRoute();
})();

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
function loadScript(src) {
  return new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.src = src;
    script.onload = resolve;
    script.onerror = reject;
    document.body.appendChild(script);
  });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
document.addEventListener('DOMContentLoaded', () => {
  const themeToggleContainer = document.getElementById('theme-toggle-container');
  if (themeToggleContainer && window.themeManager) {
    window.themeManager.createThemeToggle(themeToggleContainer);
  }
});
</script>
</div>
</body>
</html>
